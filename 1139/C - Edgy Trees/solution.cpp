#include<bits/stdc++.h>using namespace std;typedef long long ll;ll binexp(ll a,ll b,ll mod){    ll res=1;    while(b>0){        if(b&1){            res=(res*a)%mod;        }        a=(a*a)%mod;        b>>=1;    }    return res;}ll dfs(ll node,vector<vector<ll>> &adj,vector<bool> &vis){    vis[node]=true;    ll count=1;    for(auto &it:adj[node]){        if(!vis[it]){            count+=dfs(it,adj,vis);        }    }    return count;}int main(){    cin.tie(0);    ios::sync_with_stdio(0);    ll n,k;    cin>>n>>k;    vector<vector<ll>> adj(n);    for(int i=0;i<n-1;i++){        ll u,v,c;        cin>>u>>v>>c;        u--;        v--;        if(c==0){            adj[u].push_back(v);            adj[v].push_back(u);        }    }    vector<bool> vis(n,false);    ll ans=0;    for(int i=0;i<n;i++){        if(!vis[i]){            ll sz=dfs(i,adj,vis);            ans=(ans+binexp(sz,k,1e9+7))%((ll)1e9+7);        }    }    cout<<(binexp(n,k,1e9+7)-ans+((ll)1e9+7))%((ll)1e9+7)<<endl;}