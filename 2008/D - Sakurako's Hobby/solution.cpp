#include <bits/stdc++.h>using namespace std;typedef long long ll;int main() {	// your code goes here    ios_base::sync_with_stdio(false);    cin.tie(0);    int t;    cin>>t;    while(t--){        int n;        cin>>n;        vector<ll> a(n);        for(int i=0;i<n;i++){            cin>>a[i];        }        string s;        cin>>s;        map<ll,ll> mp;        ll color=1;        vector<bool> vis(n,false);        vector<ll> ans(n,0);        for(int i=0;i<n;i++){            ll count=0;            ll num=i+1;            if(vis[num-1]){                cout<<mp[ans[num-1]]<<" ";                continue;            }            while(!vis[num-1]){                vis[num-1]=true;                if(s[num-1]=='0')count++;                num=a[num-1];                ans[num-1]=color;            }            mp[color]=count;            cout<<mp[color]<<" ";            color++;        }        cout<<endl;    }}